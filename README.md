重构了全部代码，从示范学习，强化学习baseline性能超过传统方法
运行offline_train_drrn.py
主要相关函数：
train_drrn_without_priority(),
sample_create()
train_network_without_priority()




best：最佳排列，即此评价体系下的最佳结果，上帝才能做到的完美答案
worst：最差排列
episode：训练轮数
dim：滑动窗口的大小，state维度为dim*100、
实验一 ：状态表示对强化学习推荐性能的影响
1.滑动窗口大小对性能的影响，n为[10,15,20,25,30,35,40,45,50,55,60]
2.训练伦茨对性能的影响，每个滑动窗口训练6000轮，每百个轮次一个模型
3.不同padding的性能影响，0填充，1填充，最热物品列表特征向量填充
约2000个模型需要训练，大概两个月
硬件配置
cpu：13900k
gpu：rtx4090（单精度浮点训练下约为8张v100，3张a100）
model                         |precision@5 |precision@10|precision@15|precision@20|ndcg@5      |ndcg@10     |ndcg@15     |ndcg@20     |
result_best                   |0.9138742   |0.7752318   |0.6673731   |0.5837169   |1.0000000   |1.0000000   |1.0000000   |1.0000000   |
result_worst                  |0.2272848   |0.2899338   |0.2976490   |0.2925662   |0.8453137   |0.7842482   |0.7591288   |0.7450057   |
result_random                 |0.5867550   |0.5338742   |0.4791170   |0.4338907   |0.8687449   |0.8403910   |0.8332720   |0.8311111   |
result_popularity             |0.6930132   |0.6074503   |0.5336645   |0.4760348   |0.9008626   |0.8825751   |0.8781703   |0.8768269   |
result_drrn                   |0.7166538   |0.6927637   |0.6569669   |0.6116628   |0.8998819   |0.8772692   |0.8710887   |0.8692468   |
drrn__episode100_dim_10       |0.7014570   |0.6121192   |0.5383996   |0.4801159   |0.9015718   |0.8839035   |0.8791294   |0.8778153   |
drrn__episode200_dim_10       |0.7010596   |0.6144205   |0.5403753   |0.4818626   |0.9015889   |0.8842908   |0.8792300   |0.8780674   |
drrn__episode300_dim_10       |0.7010596   |0.6144205   |0.5403753   |0.4818626   |0.9015889   |0.8842908   |0.8792300   |0.8780674   |
drrn__episode400_dim_10       |0.7010596   |0.6144205   |0.5403753   |0.4818626   |0.9015889   |0.8842908   |0.8792300   |0.8780674   |
drrn__episode500_dim_10       |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041212   |0.8864477   |0.8818811   |0.8808271   |
drrn__episode600_dim_10       |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041212   |0.8864477   |0.8818811   |0.8808271   |
drrn__episode700_dim_10       |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041212   |0.8864477   |0.8818811   |0.8808271   |
drrn__episode800_dim_10       |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041212   |0.8864477   |0.8818811   |0.8808271   |
drrn__episode900_dim_10       |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041152   |0.8864435   |0.8818781   |0.8808245   |
drrn__episode1000_dim_10      |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041152   |0.8864435   |0.8818781   |0.8808245   |
drrn__episode1100_dim_10      |0.7078146   |0.6176821   |0.5438190   |0.4848924   |0.9041152   |0.8864435   |0.8818781   |0.8808245   |
drrn__episode1200_dim_10      |0.7077815   |0.6176821   |0.5438190   |0.4848924   |0.9041227   |0.8864471   |0.8818803   |0.8808259   |
drrn__episode1300_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1400_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1500_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1600_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1700_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1800_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode1900_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2000_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2100_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2200_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2300_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2400_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2500_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2600_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2700_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2800_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode2900_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3000_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3100_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3200_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3300_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3400_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3500_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3600_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3700_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3800_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode3900_dim_10      |0.7081457   |0.6173344   |0.5436755   |0.4845861   |0.9040978   |0.8867631   |0.8819646   |0.8808874   |
drrn__episode4000_dim_10      |0.7109272   |0.6196854   |0.5448344   |0.4848593   |0.9060531   |0.8886303   |0.8843616   |0.8830002   |
drrn__episode4100_dim_10      |0.7109934   |0.6196689   |0.5448344   |0.4848510   |0.9060116   |0.8886090   |0.8843370   |0.8829761   |
drrn__episode4200_dim_10      |0.7109934   |0.6196689   |0.5448344   |0.4848510   |0.9060116   |0.8886090   |0.8843370   |0.8829761   |
drrn__episode4300_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4400_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4500_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4600_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4700_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4800_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode4900_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5000_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5100_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5200_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5300_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5400_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5500_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5600_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5700_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5800_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode5900_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode6000_dim_10      |0.7109603   |0.6196689   |0.5448344   |0.4848510   |0.9060345   |0.8886199   |0.8843483   |0.8829875   |
drrn__episode100_dim_15       |0.6658278   |0.5869040   |0.5193267   |0.4642053   |0.8902411   |0.8696404   |0.8642013   |0.8628586   |
drrn__episode200_dim_15       |0.6658278   |0.5869040   |0.5193267   |0.4642053   |0.8902411   |0.8696404   |0.8642013   |0.8628586   |
drrn__episode300_dim_15       |0.6658278   |0.5869040   |0.5193267   |0.4642053   |0.8902411   |0.8696404   |0.8642013   |0.8628586   |
drrn__episode400_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode500_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode600_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode700_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode800_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode900_dim_15       |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode1000_dim_15      |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode1100_dim_15      |0.6952318   |0.6094040   |0.5360596   |0.4785513   |0.9006025   |0.8820348   |0.8777809   |0.8763386   |
drrn__episode1200_dim_15      |0.7023510   |0.6150993   |0.5404305   |0.4816556   |0.9029556   |0.8851497   |0.8808992   |0.8797407   |
drrn__episode1300_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1400_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1500_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1600_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1700_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1800_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
drrn__episode1900_dim_15      |0.7022517   |0.6145861   |0.5410596   |0.4815977   |0.9032335   |0.8855052   |0.8812732   |0.8800842   |
